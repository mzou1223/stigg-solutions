"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.buildUsageKey = exports.buildCustomerKey = exports.buildCachedCustomerKey = exports.buildLockKey = void 0;
const CUSTOMER_PREFIX = 'c_';
const RESOURCE_PREFIX = 'r_';
const FEATURE_PREFIX = 'f_';
function buildLockKey(environmentPrefix, customerId, resourceId, operationName) {
    let lockKey = environmentPrefix;
    if (operationName) {
        lockKey = `${lockKey}:${operationName}`;
    }
    lockKey = `${lockKey}-${customerId}`; // using - instead of : for backward compatability
    if (resourceId) {
        lockKey = `${lockKey}:${resourceId}`;
    }
    return lockKey;
}
exports.buildLockKey = buildLockKey;
const buildCachedCustomerKey = (customerId, resourceId) => {
    let key = `${CUSTOMER_PREFIX}${customerId}`;
    if (resourceId) {
        const resourceKey = `${RESOURCE_PREFIX}${resourceId}`;
        key = `${key}:${resourceKey}`;
    }
    return key;
};
exports.buildCachedCustomerKey = buildCachedCustomerKey;
const buildCustomerKey = (environmentPrefix, customerId, resourceId) => {
    const customerKey = (0, exports.buildCachedCustomerKey)(customerId, resourceId);
    return `${environmentPrefix}:${customerKey}`;
};
exports.buildCustomerKey = buildCustomerKey;
const buildUsageKey = (environmentPrefix, customerId, featureId, resourceId) => {
    const key = (0, exports.buildCustomerKey)(environmentPrefix, customerId, resourceId);
    return `${key}:${FEATURE_PREFIX}${featureId}`;
};
exports.buildUsageKey = buildUsageKey;
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiY2FjaGVLZXlzSGVscGVycy5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzIjpbIi4uLy4uL3NyYy91dGlscy9jYWNoZUtleXNIZWxwZXJzLnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7OztBQUFBLE1BQU0sZUFBZSxHQUFHLElBQUksQ0FBQztBQUM3QixNQUFNLGVBQWUsR0FBRyxJQUFJLENBQUM7QUFDN0IsTUFBTSxjQUFjLEdBQUcsSUFBSSxDQUFDO0FBRTVCLFNBQWdCLFlBQVksQ0FDMUIsaUJBQXlCLEVBQ3pCLFVBQWtCLEVBQ2xCLFVBQThCLEVBQzlCLGFBQXNCO0lBRXRCLElBQUksT0FBTyxHQUFHLGlCQUFpQixDQUFDO0lBRWhDLElBQUksYUFBYSxFQUFFO1FBQ2pCLE9BQU8sR0FBRyxHQUFHLE9BQU8sSUFBSSxhQUFhLEVBQUUsQ0FBQztLQUN6QztJQUVELE9BQU8sR0FBRyxHQUFHLE9BQU8sSUFBSSxVQUFVLEVBQUUsQ0FBQyxDQUFDLGtEQUFrRDtJQUV4RixJQUFJLFVBQVUsRUFBRTtRQUNkLE9BQU8sR0FBRyxHQUFHLE9BQU8sSUFBSSxVQUFVLEVBQUUsQ0FBQztLQUN0QztJQUVELE9BQU8sT0FBTyxDQUFDO0FBQ2pCLENBQUM7QUFuQkQsb0NBbUJDO0FBRU0sTUFBTSxzQkFBc0IsR0FBRyxDQUFDLFVBQWtCLEVBQUUsVUFBOEIsRUFBVSxFQUFFO0lBQ25HLElBQUksR0FBRyxHQUFHLEdBQUcsZUFBZSxHQUFHLFVBQVUsRUFBRSxDQUFDO0lBQzVDLElBQUksVUFBVSxFQUFFO1FBQ2QsTUFBTSxXQUFXLEdBQUcsR0FBRyxlQUFlLEdBQUcsVUFBVSxFQUFFLENBQUM7UUFDdEQsR0FBRyxHQUFHLEdBQUcsR0FBRyxJQUFJLFdBQVcsRUFBRSxDQUFDO0tBQy9CO0lBRUQsT0FBTyxHQUFHLENBQUM7QUFDYixDQUFDLENBQUM7QUFSVyxRQUFBLHNCQUFzQiwwQkFRakM7QUFFSyxNQUFNLGdCQUFnQixHQUFHLENBQUMsaUJBQXlCLEVBQUUsVUFBa0IsRUFBRSxVQUE4QixFQUFFLEVBQUU7SUFDaEgsTUFBTSxXQUFXLEdBQUcsSUFBQSw4QkFBc0IsRUFBQyxVQUFVLEVBQUUsVUFBVSxDQUFDLENBQUM7SUFDbkUsT0FBTyxHQUFHLGlCQUFpQixJQUFJLFdBQVcsRUFBRSxDQUFDO0FBQy9DLENBQUMsQ0FBQztBQUhXLFFBQUEsZ0JBQWdCLG9CQUczQjtBQUVLLE1BQU0sYUFBYSxHQUFHLENBQzNCLGlCQUF5QixFQUN6QixVQUFrQixFQUNsQixTQUFpQixFQUNqQixVQUE4QixFQUM5QixFQUFFO0lBQ0YsTUFBTSxHQUFHLEdBQUcsSUFBQSx3QkFBZ0IsRUFBQyxpQkFBaUIsRUFBRSxVQUFVLEVBQUUsVUFBVSxDQUFDLENBQUM7SUFFeEUsT0FBTyxHQUFHLEdBQUcsSUFBSSxjQUFjLEdBQUcsU0FBUyxFQUFFLENBQUM7QUFDaEQsQ0FBQyxDQUFDO0FBVFcsUUFBQSxhQUFhLGlCQVN4QiJ9